<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Auth Demo</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    .section-levee {
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 8px;
      background: #f8fafc;
      margin-top: 8px;
    }
    .section-levee label { display:block; margin-top:6px; }
    @media (prefers-color-scheme: dark) {
      .section-levee {
        border-color: #334155;
        background: rgba(255,255,255,0.06);
        color: #e2e8f0;
      }
      .section-levee input,
      .section-levee textarea,
      .section-levee select {
        background: rgba(255,255,255,0.08);
        color: #e2e8f0;
        border: 1px solid #475569;
      }
    }
  </style>
</head>
<body>
  <div id="sidebar-holder"></div>
  <link rel="stylesheet" href="/sidebar.css">
  <script src="/sidebar.js" defer></script>
  <script src="/theme.js" defer></script>
  <!-- Librairies pour l’export PDF -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js"></script>
  <div id="login-container">
    <h2>Connexion</h2>
    <form id="login-form">
      <input type="email" id="email" placeholder="Email" required />
      <input type="password" id="password" placeholder="Mot de passe" required />
      <button type="submit">Se connecter</button>
    </form>
    <div id="login-error" style="color:red;"></div>
  </div>

  <div id="app-container" style="display:none;">
    <h1>Bienvenue</h1>
    <button id="logoutBtn">Déconnexion</button>
    <nav>
      <a href="selection.html" id="nav-selection" class="btn btn-primary">
        Gestion des tâches
      </a>
      <button id="historiqueBtn" class="btn btn-secondary">
        Historique des bulles
      </button>
    </nav>
    <label>Chantier :
      <select id="chantierSelect"></select>
    </label>

    <label>Étage :
      <select id="etageSelect">
        <!-- valeur lisible R+X mais l'identifiant numérique est dans data-floor-id -->
        <option value="R+0" data-floor-id="0">R+0</option>
        <option value="R+1" data-floor-id="1">R+1</option>
        <option value="R+2" data-floor-id="2">R+2</option>
        <option value="R+3" data-floor-id="3">R+3</option>
        <option value="R+4" data-floor-id="4">R+4</option>
        <option value="R+5" data-floor-id="5">R+5</option>
      </select>
    </label>

    <label>Chambre :
      <select id="chambreSelect" data-etage="R+5">
        <option value="total">-- Toutes les chambres --</option>
        <!-- etc. -->
      </select>
    </label>

    <label>Statut :
      <select id="statusFilter">
        <option value="">-- Tous les statuts --</option>
        <option value="attente">En attente</option>
        <option value="a_corriger">À corriger</option>
        <option value="corrige">Corrigé</option>
        <option value="validee">Validé</option>
        <option value="abandonnee">Abandonné</option>
      </select>
    </label>

    <!-- Format d’export -->
    <label for="export-format">Format :</label>
    <select id="export-format">
      <option value="csv">CSV</option>
      <option value="xlsx">Excel</option>
      <option value="pdf">PDF</option>
    </select>
    <fieldset id="export-columns">
      <legend>Colonnes à inclure :</legend>
      <label><input type="checkbox" name="col" value="id" checked> ID</label>
      <label><input type="checkbox" name="col" value="created_by_email" checked> Utilisateur</label>
      <label><input type="checkbox" name="col" value="modified_by_email"> Modifié par (email)</label>
      <label><input type="checkbox" name="col" value="etage" checked> Étage</label>
      <label><input type="checkbox" name="col" value="chambre" checked> Chambre</label>
      <label><input type="checkbox" name="col" value="numero" checked> N°</label>
      <label><input type="checkbox" name="col" value="lot" checked> Lot</label>
      <label><input type="checkbox" name="col" value="intitule" checked> Intitulé</label>
      <label><input type="checkbox" name="col" value="description" checked> Description</label>
      <label><input type="checkbox" name="col" value="etat" checked> État</label>
      <label><input type="checkbox" name="col" value="entreprise" checked> Entreprise</label>
      <label><input type="checkbox" name="col" value="localisation" checked> Localisation</label>
      <label><input type="checkbox" name="col" value="observation" checked> Observation</label>
      <label><input type="checkbox" name="col" value="date_butoir" checked> Date butoir</label>
      <label><input type="checkbox" name="col" value="photos" checked> Photos (tous les liens)</label>
      <label><input type="checkbox" name="col" value="videos" checked> Vidéos (tous les liens)</label>
      <label><input type="checkbox" name="col" value="levee_fait_par_email" checked> Levée – Fait par</label>
      <label><input type="checkbox" name="col" value="levee_fait_le" checked> Levée – Fait le</label>
      <label><input type="checkbox" name="col" value="levee_commentaire" checked> Levée – Commentaire</label>
      <label><input type="checkbox" name="col" value="levee_photos" checked> Levée – Photos</label>
    </fieldset>
    <!-- Nouveau bouton Export -->
    <button id="exportBtn">Exporter</button>

    <div id="plan-container">
      <img id="plan" src="plan-r5.png" alt="Plan étage" />
      <div id="bulles-container"></div>
    </div>
  </div>

  <script src="script.js"></script>
  <script src="selection.js"></script>
</body>
</html>
